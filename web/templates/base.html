<!DOCTYPE html>
<html lang="es" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      {% block title %}Sistema de Evaluación Crediticia{% endblock %}
    </title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Custom Tailwind Config -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ["Inter", "system-ui", "sans-serif"],
            },
            colors: {
              primary: {
                50: "#eef2ff",
                100: "#e0e7ff",
                200: "#c7d2fe",
                300: "#a5b4fc",
                400: "#818cf8",
                500: "#6366f1",
                600: "#4f46e5",
                700: "#4338ca",
                800: "#3730a3",
                900: "#312e81",
                950: "#1e1b4b",
              },
              slate: {
                850: "#172033",
              },
              success: "#10b981",
              warning: "#f59e0b",
              danger: "#ef4444",
              info: "#3b82f6",
            },
            backdropBlur: {
              xs: "2px",
            },
            boxShadow: {
              glass: "0 8px 32px 0 rgba(31, 38, 135, 0.15)",
              "glass-sm": "0 4px 16px 0 rgba(31, 38, 135, 0.1)",
              "glass-lg": "0 12px 48px 0 rgba(31, 38, 135, 0.2)",
              glow: "0 0 20px rgba(99, 102, 241, 0.3)",
              "glow-success": "0 0 20px rgba(16, 185, 129, 0.3)",
              "glow-danger": "0 0 20px rgba(239, 68, 68, 0.3)",
            },
          },
        },
      };
    </script>

    <!-- Custom Styles -->
    <style>
      /* === GLASSMORPHISM BASE === */
      body {
        font-family: "Inter", system-ui, sans-serif;
        background: linear-gradient(
          135deg,
          #667eea 0%,
          #764ba2 50%,
          #6b8dd6 100%
        );
        background-attachment: fixed;
        min-height: 100vh;
      }

      /* Glass Card Effect */
      .glass {
        background: rgba(255, 255, 255, 0.65);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.25);
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
      }

      .glass-light {
        background: rgba(255, 255, 255, 0.5);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .glass-dark {
        background: rgba(30, 27, 75, 0.85);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(99, 102, 241, 0.2);
      }

      .glass-sidebar {
        background: linear-gradient(
          180deg,
          rgba(30, 27, 75, 0.92) 0%,
          rgba(49, 46, 129, 0.88) 100%
        );
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
      }

      /* Glass Cards for Dashboard */
      .glass-card {
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 1rem;
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
        transition: all 0.3s ease;
      }

      .glass-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
        background: rgba(255, 255, 255, 0.7);
      }

      /* Glass Card Strong - más opaco para contenido importante */
      .glass-card-strong {
        background: rgba(255, 255, 255, 0.75);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.35);
        border-radius: 1rem;
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
      }

      .glass-card-strong:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
        background: rgba(255, 255, 255, 0.85);
      }

      /* Gradient Text */
      .gradient-text {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      /* === FORM INPUTS WITH GLASS EFFECT === */
      input[type="text"],
      input[type="number"],
      input[type="email"],
      input[type="password"],
      input[type="date"],
      input[type="tel"],
      select,
      textarea {
        display: block;
        width: 100%;
        padding: 0.75rem 1rem;
        font-size: 0.875rem;
        line-height: 1.5;
        color: #1e293b;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        border: 1px solid rgba(203, 213, 225, 0.8);
        border-radius: 0.75rem;
        transition: all 0.2s ease;
        appearance: none;
      }

      input[type="text"]:focus,
      input[type="number"]:focus,
      input[type="email"]:focus,
      input[type="password"]:focus,
      input[type="date"]:focus,
      input[type="tel"]:focus,
      select:focus,
      textarea:focus {
        border-color: #818cf8;
        outline: none;
        box-shadow: 0 0 0 4px rgba(129, 140, 248, 0.15),
          0 4px 12px rgba(99, 102, 241, 0.1);
        background: rgba(255, 255, 255, 1);
      }

      input::placeholder {
        color: #94a3b8;
      }

      /* Select with custom arrow */
      select {
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236366f1' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
        background-position: right 0.875rem center;
        background-repeat: no-repeat;
        background-size: 1.25em 1.25em;
        padding-right: 2.75rem;
      }

      select::-ms-expand {
        display: none;
      }

      .form-select {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        border: 1px solid rgba(203, 213, 225, 0.8);
        border-radius: 0.75rem;
        padding: 0.75rem 2.75rem 0.75rem 1rem;
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236366f1' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
        background-position: right 0.875rem center;
        background-repeat: no-repeat;
        background-size: 1.25em 1.25em;
        transition: all 0.2s ease;
      }

      .form-select:focus {
        border-color: #818cf8;
        box-shadow: 0 0 0 4px rgba(129, 140, 248, 0.15),
          0 4px 12px rgba(99, 102, 241, 0.1);
        outline: none;
      }

      /* === BUTTONS WITH MODERN STYLE === */
      .btn-primary {
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 0.75rem;
        font-weight: 500;
        transition: all 0.2s ease;
        box-shadow: 0 4px 14px rgba(99, 102, 241, 0.35);
      }

      .btn-primary:hover {
        transform: translateY(-1px);
        box-shadow: 0 6px 20px rgba(99, 102, 241, 0.45);
      }

      .btn-secondary {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(8px);
        color: #4f46e5;
        padding: 0.75rem 1.5rem;
        border-radius: 0.75rem;
        font-weight: 500;
        border: 1px solid rgba(99, 102, 241, 0.3);
        transition: all 0.2s ease;
      }

      .btn-secondary:hover {
        background: rgba(99, 102, 241, 0.1);
        border-color: rgba(99, 102, 241, 0.5);
      }

      /* === SCROLLBAR === */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      ::-webkit-scrollbar-track {
        background: rgba(241, 245, 249, 0.5);
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, #a5b4fc 0%, #818cf8 100%);
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(180deg, #818cf8 0%, #6366f1 100%);
      }

      /* === ANIMATIONS === */
      .fade-in {
        animation: fadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-8px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .slide-in {
        animation: slideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }
      @keyframes slideIn {
        from {
          transform: translateX(-100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }

      .scale-in {
        animation: scaleIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      @keyframes scaleIn {
        from {
          opacity: 0;
          transform: scale(0.95);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      .float {
        animation: float 6s ease-in-out infinite;
      }
      @keyframes float {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-10px);
        }
      }

      /* Shimmer effect for loading states */
      .shimmer {
        background: linear-gradient(
          90deg,
          rgba(255, 255, 255, 0) 0%,
          rgba(255, 255, 255, 0.5) 50%,
          rgba(255, 255, 255, 0) 100%
        );
        background-size: 200% 100%;
        animation: shimmer 1.5s infinite;
      }
      @keyframes shimmer {
        0% {
          background-position: -200% 0;
        }
        100% {
          background-position: 200% 0;
        }
      }

      /* Pulse glow effect */
      .pulse-glow {
        animation: pulseGlow 2s ease-in-out infinite;
      }
      @keyframes pulseGlow {
        0%,
        100% {
          box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.4);
        }
        50% {
          box-shadow: 0 0 20px 4px rgba(99, 102, 241, 0.2);
        }
      }

      /* Score meter with gradient */
      .score-meter {
        background: linear-gradient(
          to right,
          #ef4444 0%,
          #f97316 25%,
          #eab308 50%,
          #84cc16 75%,
          #22c55e 100%
        );
        border-radius: 9999px;
      }

      /* Modern Loader */
      .loader {
        width: 24px;
        height: 24px;
        border: 3px solid rgba(99, 102, 241, 0.2);
        border-top: 3px solid #6366f1;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Toast notifications with glass effect */
      .toast {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.3);
        animation: toastIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }
      @keyframes toastIn {
        from {
          opacity: 0;
          transform: translateX(100%) scale(0.9);
        }
        to {
          opacity: 1;
          transform: translateX(0) scale(1);
        }
      }

      /* Drag and drop with glass */
      .drop-zone {
        border: 2px dashed rgba(99, 102, 241, 0.4);
        background: rgba(255, 255, 255, 0.5);
        backdrop-filter: blur(8px);
        transition: all 0.3s ease;
      }
      .drop-zone.dragover {
        border-color: #6366f1;
        background: rgba(99, 102, 241, 0.1);
        box-shadow: 0 0 20px rgba(99, 102, 241, 0.2);
      }

      /* Status badges with modern style */
      .badge-success {
        background: linear-gradient(
          135deg,
          rgba(16, 185, 129, 0.15) 0%,
          rgba(16, 185, 129, 0.1) 100%
        );
        color: #059669;
        border: 1px solid rgba(16, 185, 129, 0.3);
      }
      .badge-warning {
        background: linear-gradient(
          135deg,
          rgba(245, 158, 11, 0.15) 0%,
          rgba(245, 158, 11, 0.1) 100%
        );
        color: #d97706;
        border: 1px solid rgba(245, 158, 11, 0.3);
      }
      .badge-danger {
        background: linear-gradient(
          135deg,
          rgba(239, 68, 68, 0.15) 0%,
          rgba(239, 68, 68, 0.1) 100%
        );
        color: #dc2626;
        border: 1px solid rgba(239, 68, 68, 0.3);
      }

      /* Table with glass effect */
      .glass-table {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(16px);
        border-radius: 1rem;
        overflow: hidden;
      }
      .glass-table thead {
        background: rgba(248, 250, 252, 0.95);
      }
      .glass-table tbody tr {
        transition: all 0.2s ease;
      }
      .glass-table tbody tr:hover {
        background: rgba(99, 102, 241, 0.04);
      }

      /* Sidebar nav items */
      .nav-item {
        transition: all 0.2s ease;
        border-radius: 0.75rem;
      }
      .nav-item:hover {
        background: rgba(255, 255, 255, 0.1);
      }
      .nav-item.active {
        background: linear-gradient(
          135deg,
          rgba(99, 102, 241, 0.3) 0%,
          rgba(139, 92, 246, 0.2) 100%
        );
        box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
      }

      /* Chart container with glass */
      .chart-container {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(16px);
        border: 1px solid rgba(255, 255, 255, 0.4);
        border-radius: 1rem;
        padding: 1.5rem;
      }

      /* Modal with glass backdrop */
      .modal-backdrop {
        background: rgba(15, 23, 42, 0.6);
        backdrop-filter: blur(4px);
      }
      .modal-content {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 1.25rem;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      }

      /* Risk level indicators */
      .risk-low {
        background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
        box-shadow: 0 4px 14px rgba(16, 185, 129, 0.35);
      }
      .risk-medium {
        background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);
        box-shadow: 0 4px 14px rgba(245, 158, 11, 0.35);
      }
      .risk-high {
        background: linear-gradient(135deg, #ef4444 0%, #f87171 100%);
        box-shadow: 0 4px 14px rgba(239, 68, 68, 0.35);
      }

      /* Stat cards */
      .stat-card {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(16px);
        border: 1px solid rgba(255, 255, 255, 0.4);
        border-radius: 1rem;
        transition: all 0.3s ease;
      }
      .stat-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.1);
      }

      /* Decorative blobs for background */
      .blob {
        position: fixed;
        border-radius: 50%;
        filter: blur(60px);
        opacity: 0.5;
        z-index: -1;
        pointer-events: none;
      }
      .blob-1 {
        width: 400px;
        height: 400px;
        background: rgba(99, 102, 241, 0.4);
        top: -100px;
        right: -100px;
      }
      .blob-2 {
        width: 300px;
        height: 300px;
        background: rgba(139, 92, 246, 0.4);
        bottom: 100px;
        left: 200px;
      }
      .blob-3 {
        width: 350px;
        height: 350px;
        background: rgba(236, 72, 153, 0.3);
        bottom: -100px;
        right: 200px;
      }
    </style>

    {% block extra_head %}{% endblock %}
  </head>
  <body class="h-full">
    <!-- Decorative Background Blobs -->
    <div class="blob blob-1"></div>
    <div class="blob blob-2"></div>
    <div class="blob blob-3"></div>

    <div class="min-h-full">
      <!-- Sidebar with Glass Effect -->
      <div
        class="fixed inset-y-0 left-0 z-50 w-64 glass-sidebar transition-transform duration-300 ease-in-out lg:translate-x-0"
        id="sidebar"
      >
        <!-- Logo -->
        <div
          class="flex h-16 items-center justify-center border-b border-white/10"
        >
          <div class="flex items-center gap-3">
            <div
              class="flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-indigo-400 to-purple-500 shadow-lg"
            >
              <svg
                class="h-6 w-6 text-white"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                ></path>
              </svg>
            </div>
            <span class="text-xl font-bold text-white">CreditScore</span>
          </div>
        </div>

        <!-- Navigation -->
        <nav class="mt-6 px-4">
          <div class="space-y-2">
            <!-- Dashboard -->
            <a
              href="{{ url_for('dashboard') }}"
              class="nav-item group flex items-center gap-3 px-3 py-2.5 text-sm font-medium {% if active_page == 'dashboard' %}active text-white{% else %}text-indigo-200 hover:text-white{% endif %}"
            >
              <svg
                class="h-5 w-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
                ></path>
              </svg>
              Dashboard
            </a>

            <!-- Evaluación Individual -->
            <a
              href="{{ url_for('evaluacion') }}"
              class="nav-item group flex items-center gap-3 px-3 py-2.5 text-sm font-medium {% if active_page == 'evaluacion' %}active text-white{% else %}text-indigo-200 hover:text-white{% endif %}"
            >
              <svg
                class="h-5 w-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                ></path>
              </svg>
              Evaluación Individual
            </a>

            <!-- Cartera de Clientes -->
            <a
              href="{{ url_for('test_data_view') }}"
              class="nav-item group flex items-center gap-3 px-3 py-2.5 text-sm font-medium {% if active_page == 'test_data' %}active text-white{% else %}text-indigo-200 hover:text-white{% endif %}"
            >
              <svg
                class="h-5 w-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                ></path>
              </svg>
              Datos de Prueba
            </a>

            <!-- Evaluación por Lote -->
            <!-- Evaluación por Lote -->
            <a
              href="{{ url_for('lote') }}"
              class="nav-item group flex items-center gap-3 px-3 py-2.5 text-sm font-medium {% if active_page == 'lote' %}active text-white{% else %}text-indigo-200 hover:text-white{% endif %}"
            >
              <svg
                class="h-5 w-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
                ></path>
              </svg>
              Evaluación por Lote
            </a>

            <!-- Historial -->
            <a
              href="{{ url_for('historial') }}"
              class="nav-item group flex items-center gap-3 px-3 py-2.5 text-sm font-medium {% if active_page == 'historial' %}active text-white{% else %}text-indigo-200 hover:text-white{% endif %}"
            >
              <svg
                class="h-5 w-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
                ></path>
              </svg>
              Historial
            </a>
          </div>

          <!-- Separador -->
          <div class="my-6 border-t border-white/10"></div>

          <!-- Sección Configuración -->
          <div class="space-y-2">
            <p
              class="px-3 text-xs font-semibold uppercase tracking-wider text-indigo-300/70"
            >
              Sistema
            </p>

            <a
              href="{{ url_for('configuracion') }}"
              class="nav-item group flex items-center gap-3 px-3 py-2.5 text-sm font-medium {% if active_page == 'configuracion' %}active text-white{% else %}text-indigo-200 hover:text-white{% endif %}"
            >
              <svg
                class="h-5 w-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"
                ></path>
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                ></path>
              </svg>
              Configuración
            </a>
          </div>
        </nav>

        <!-- Footer del Sidebar -->
        <div
          class="absolute bottom-0 left-0 right-0 border-t border-white/10 p-4"
        >
          <div class="flex items-center gap-3">
            <div
              class="h-10 w-10 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center shadow-lg"
            >
              <svg
                class="h-5 w-5 text-white"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                ></path>
              </svg>
            </div>
            <div class="flex-1 min-w-0">
              <p class="text-sm font-medium text-white truncate">
                Analista de Crédito
              </p>
              <p class="text-xs text-primary-300 truncate">Sistema v1.0</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Mobile menu button -->
      <div class="lg:hidden fixed top-4 left-4 z-50">
        <button
          type="button"
          onclick="toggleSidebar()"
          class="rounded-lg bg-primary-600 p-2 text-white shadow-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
        >
          <svg
            class="h-6 w-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"
            ></path>
          </svg>
        </button>
      </div>

      <!-- Main Content -->
      <div class="lg:pl-64">
        <!-- Top Bar with Glass Effect -->
        <header
          class="sticky top-0 z-40 flex h-16 items-center gap-4 px-4 sm:px-6 lg:px-8 glass border-b border-white/20"
        >
          <div class="flex flex-1 items-center justify-between">
            <h1 class="text-lg font-semibold text-slate-800">
              {% block page_title %}Dashboard{% endblock %}
            </h1>

            <div class="flex items-center gap-4">
              <!-- Notificaciones -->
              <button
                type="button"
                class="relative rounded-xl bg-white/50 backdrop-blur p-2.5 text-slate-500 hover:bg-white/80 hover:text-indigo-600 transition-all shadow-sm border border-white/30"
              >
                <svg
                  class="h-5 w-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"
                  ></path>
                </svg>
                <span
                  class="absolute right-1.5 top-1.5 h-2 w-2 rounded-full bg-gradient-to-r from-red-500 to-pink-500 ring-2 ring-white"
                ></span>
              </button>

              <!-- Fecha actual -->
              <div
                class="hidden sm:flex items-center gap-2 px-4 py-2 rounded-xl bg-white/50 backdrop-blur border border-white/30 shadow-sm"
              >
                <svg
                  class="h-4 w-4 text-indigo-500"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                  ></path>
                </svg>
                <span
                  id="current-date"
                  class="text-sm font-medium text-slate-600"
                ></span>
              </div>
            </div>
          </div>
        </header>

        <!-- Page Content -->
        <main class="p-4 sm:p-6 lg:p-8 fade-in">
          {% block content %}{% endblock %}
        </main>
      </div>

      <!-- Toast Container -->
      <div
        id="toast-container"
        class="fixed bottom-4 right-4 z-50 space-y-2"
      ></div>
    </div>

    <!-- Scripts Globales -->
    <script>
      // Toggle sidebar en móvil
      function toggleSidebar() {
        const sidebar = document.getElementById("sidebar");
        sidebar.classList.toggle("-translate-x-full");
      }

      // Cerrar sidebar al hacer click fuera (móvil)
      document.addEventListener("click", function (e) {
        const sidebar = document.getElementById("sidebar");
        const menuButton = document.querySelector(
          '[onclick="toggleSidebar()"]'
        );

        if (
          window.innerWidth < 1024 &&
          !sidebar.contains(e.target) &&
          !menuButton.contains(e.target) &&
          !sidebar.classList.contains("-translate-x-full")
        ) {
          sidebar.classList.add("-translate-x-full");
        }
      });

      // Fecha actual
      function updateDate() {
        const options = {
          weekday: "long",
          year: "numeric",
          month: "long",
          day: "numeric",
        };
        const dateEl = document.getElementById("current-date");
        if (dateEl) {
          const date = new Date().toLocaleDateString("es-ES", options);
          dateEl.textContent = date.charAt(0).toUpperCase() + date.slice(1);
        }
      }
      updateDate();

      // Sistema de notificaciones Toast
      function showToast(message, type = "info", duration = 5000) {
        const container = document.getElementById("toast-container");
        const toast = document.createElement("div");

        const colors = {
          success: "bg-green-500",
          error: "bg-red-500",
          warning: "bg-yellow-500",
          info: "bg-blue-500",
        };

        const icons = {
          success:
            '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>',
          error:
            '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>',
          warning:
            '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>',
          info: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>',
        };

        toast.className = `toast flex items-center gap-3 px-4 py-3 rounded-lg text-white shadow-lg ${colors[type]}`;
        toast.innerHTML = `
                <svg class="h-5 w-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    ${icons[type]}
                </svg>
                <p class="text-sm font-medium">${message}</p>
                <button onclick="this.parentElement.remove()" class="ml-auto text-white/80 hover:text-white">
                    <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            `;

        container.appendChild(toast);

        setTimeout(() => {
          toast.style.animation = "toastIn 0.3s ease-out reverse";
          setTimeout(() => toast.remove(), 300);
        }, duration);
      }

      // Formatear moneda
      function formatCurrency(value) {
        return new Intl.NumberFormat("es-MX", {
          style: "currency",
          currency: "USD",
        }).format(value);
      }

      // Formatear porcentaje
      function formatPercent(value) {
        return `${value.toFixed(1)}%`;
      }

      // Loading overlay
      function showLoading(element) {
        element.innerHTML = `
                <div class="flex items-center justify-center gap-2">
                    <div class="loader"></div>
                    <span>Procesando...</span>
                </div>
            `;
        element.disabled = true;
      }

      function hideLoading(element, originalText) {
        element.innerHTML = originalText;
        element.disabled = false;
      }
    </script>

    {% block extra_scripts %}{% endblock %}
  </body>
</html>
